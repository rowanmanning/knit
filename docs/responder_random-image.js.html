<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>responder/random-image.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Alias.html">Alias</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Alias.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Alias.html#composeMessage">composeMessage</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="AmbientListener.html">AmbientListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="AmbientListener.html#.create">create</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Bot.html">Bot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Bot.html#connect">connect</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Bot.html#replyTo">replyTo</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Bot.html#use">use</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="CommandListener.html">CommandListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="CommandListener.html#.create">create</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DataManager.html">DataManager</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#clearCaches">clearCaches</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#getChannelById">getChannelById</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#getChannels">getChannels</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#getChannelsById">getChannelsById</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#getUserById">getUserById</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#getUsers">getUsers</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DataManager.html#getUsersById">getUsersById</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ImageResponder.html">ImageResponder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ImageResponder.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ImageResponder.html#respond">respond</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Listener.html">Listener</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="MessageResponder.html">MessageResponder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MessageResponder.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MessageResponder.html#respond">respond</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="RandomImageResponder.html">RandomImageResponder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RandomImageResponder.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RandomImageResponder.html#respond">respond</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="RandomMessageResponder.html">RandomMessageResponder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RandomMessageResponder.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RandomMessageResponder.html#respond">respond</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Responder.html">Responder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Responder.html#respond">respond</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Response.html">Response</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Response.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Response.html#as">as</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Response.html#to">to</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Response.html#with">with</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-@rowanmanning_knit.html">@rowanmanning/knit</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">responder/random-image.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

const isPlainObject = require('lodash/isPlainObject');
const Responder = require('../responder');
const sample = require('lodash/sample');

/**
 * Class representing a bot random image responder. Random image responders
 * always reply with a randomly selected image from a list, as a Slack attachment.
 * @extends Responder
 *
 * @example &lt;caption>Create a random image responder&lt;/caption>
 * new Bot.Responder.RandomImage({
 *     images: [
 *         'https://i.imgur.com/ydM3Wb4.gif',
 *         'https://media.giphy.com/media/XdACBmg3lx6RG/giphy.gif'
 *     ]
 * });
 *
 * @example &lt;caption>Create a random image responder with additional configurations&lt;/caption>
 * new Bot.Responder.RandomImage({
 *     images: [
 *         {
 *             image: 'https://i.imgur.com/ydM3Wb4.gif',
 *             label: 'Some cute goats'
 *         },
 *         {
 *             image: 'https://media.giphy.com/media/XdACBmg3lx6RG/giphy.gif',
 *             label: 'A goat with ice-skating skills'
 *         }
 *     ]
 * });
 *
 * @example &lt;caption>Create a random image responder with a default label/color&lt;/caption>
 * new Bot.Responder.RandomImage({
 *     label: 'Have a goat',
 *     color: '#ffced8',
 *     images: [
 *         'https://i.imgur.com/ydM3Wb4.gif',
 *         'https://media.giphy.com/media/XdACBmg3lx6RG/giphy.gif'
 *     ]
 * });
 */
class RandomImageResponder extends Responder {

	/**
	 * Create a bot random image responder.
	 * @param {Object} options - The responder options.
	 * @param {(String[]|Object[])} options.images - The images to respond with, one will be randomly picked each time.
	 * @param {String} [options.label] - Default text to show alongside images.
	 * @param {String} [options.color] - Default color of the image attachment, a hex code including the preceeding "#".
	 * @param {(String|Alias)} [options.alias] - The alias to respond with. This must be either an {@link Alias} or the name of one registered the bot.
	 */
	constructor(options) {
		super(options);
		if (options.label &amp;&amp; typeof options.label !== 'string') {
			throw new TypeError(`${this.constructor.name} label must be a string`);
		}
		if (options.color &amp;&amp; typeof options.color !== 'string') {
			throw new TypeError(`${this.constructor.name} color must be a string`);
		}
		if (!Array.isArray(options.images)) {
			throw new TypeError(`${this.constructor.name} images must be an array`);
		}
		for (const image of options.images) {
			if (typeof image !== 'string' &amp;&amp; !isPlainObject(image)) {
				throw new TypeError(`${this.constructor.name} images must be an array of strings or objects`);
			}
			if (typeof image !== 'string') {
				if (typeof image.image !== 'string') {
					throw new TypeError(`${this.constructor.name} each image object image must be a string`);
				}
				if (image.label &amp;&amp; typeof image.label !== 'string') {
					throw new TypeError(`${this.constructor.name} each image object label must be a string`);
				}
				if (image.color &amp;&amp; typeof image.color !== 'string') {
					throw new TypeError(`${this.constructor.name} each image object color must be a string`);
				}
			}
		}
	}

	/**
	 * Respond to an incoming message with a random responder message.
	 * @param {Object} message - The Slack message to respond to.
	 * @returns {Promise} A promise which resolves when the message is sent.
	 */
	async respond(message) {
		try {
			let image = sample(this.options.images);
			if (typeof image === 'string') {
				image = {image};
			}
			const imageAttachment = {
				/* eslint-disable camelcase */
				image_url: image.image,
				/* eslint-enable camelcase */
				fallback: image.image
			};
			if (image.color) {
				imageAttachment.color = image.color;
			} else if (this.options.color) {
				imageAttachment.color = this.options.color;
			}
			if (image.label) {
				imageAttachment.text = image.label;
				imageAttachment.fallback = `${image.label} ${image.image}`;
			} else if (this.options.label) {
				imageAttachment.text = this.options.label;
				imageAttachment.fallback = `${this.options.label} ${image.image}`;
			}
			return await super.respond(message).with({
				attachments: [imageAttachment]
			});

		} catch (error) {
			this.log.error(`Error: ${error.message}`);
		}
	}

	/**
	 * Create a bot random image responder (see {@link RandomImageResponder} for parameters).
	 * @returns {RandomImageResponder} The new random image responder.
	 */
	static create(...args) {
		return new this(...args);
	}

}

module.exports = RandomImageResponder;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
